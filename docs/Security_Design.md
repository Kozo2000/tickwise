# 🛡 Tickwise セキュリティ設計：論理の「鋼」を、投資の「盾」に

Rust製投資分析ツール「Tickwise」は、その核に「想定されるあらゆるセキュリティの配慮」を携えています。私たちが大切にしたのは、投資家にとって柔軟かつ信頼できるツールであること。データの安全性、計算の一貫性、エラーに強い可用性――これらすべての要件に妥協することなく、情熱を注ぎ込みました。

一般的には「CIA（機密性・完全性・可用性）」の順で語られますが、Tickwiseはあえてその順序を入れ替え、**「ICA」**として定義します。なぜなら、投資家にとって最も価値があるのは、何者にも汚染されない**「情報の正確性（Integrity）」**だと信じているからです。

---

## 1. 完全性（Integrity）：不変の真実（SOT）を守り抜く
Tickwiseを支えるバックボーン、それはデータ一貫性維持のための**単一の信頼可能な情報源（SOT: Source of Truth）**哲学です。

#### ● 専用ラッパー `TechnicalDataGuard` による厳格なアクセス制御
投資指標データのあらゆる操作は、専用のラッパー構造体 `TechnicalDataGuard` を通じて行われます。
- **直接アクセスの禁則化:** 「真の構造体」への直接的な読み書きをエンジニアリングレベルで禁止。必ずガード（ラッパー）を経由することを強制しています。
- **バグの根絶:** 処理系に合わせたリード/ライト用メソッドのみを提供することで、コーディングにおける不用意なバグや、計算フローの途中での予期せぬデータ破壊を徹底的に抑え込んでいます。

#### ● 単一実行による計算の唯一性
Tickwiseにおいて、各テクニカル指標の計算はプログラムのライフサイクル中で**「一度きり」**しか行われません。
- **重複計算の排除:** プログラム内の別箇所で同じ指標を再計算するロジッ# 🛡 Tickwise セキュリティ設計：論理の「鋼」を、投資の「盾」に

Rust製投資分析ツール「Tickwise」は、その核に「想定されるあらゆるセキュリティの配慮」を携えています。私たちが大切にしたのは、投資家にとって柔軟かつ信頼できるツールであること。データの安全性、計算の一貫性、エラーに強い可用性――これらすべての要件に妥協することなく、情熱を注ぎ込みました。

一般的には「CIA（機密性・完全性・可用性）」の順で語られますが、Tickwiseはあえてその順序を入れ替え、**「ICA」**として定義します。なぜなら、投資家にとって最も価値があるのは、何者にも汚染されない**「情報の正確性（Integrity）」**だと信じているからです。

---

## 1. 完全性（Integrity）：不変の真実（SOT）を守り抜く
Tickwiseを支えるバックボーン、それはデータ一貫性維持のための**単一の信頼可能な情報源（SOT: Source of Truth）**哲学です。

#### ● 専用ラッパー `TechnicalDataGuard` によるアクセス制御
投資指標データのあらゆる操作は、専用のラッパー構造体 `TechnicalDataGuard` を通じて行われます。
- **直接アクセスの禁則化:** 「真の構造体」への直接的な読み書きをエンジニアリングレベルで禁止し、必ずガード（ラッパー）を経由することを強制。コーディング時の不用意なバグやデータ破壊を構造的に抑え込んでいます。
- **単一実行による計算の唯一性:** 指標計算はプログラム内で「一度きり」しか行われません。画面、ログ、LLM。すべての出力先へ寸分違わぬ「同一の数値」を供給します。

#### ● ソフトウェア・サプライチェーンの透明性
信頼は「中身が見えること」から始まります。Tickwiseは配布プロセスにおいても完全性を追求しています。
- **SBOM (Software Bill of Materials) の提供:** CycloneDX形式のSBOMを生成。依存パッケージをすべて可視化し、脆弱性管理（VEX）を可能にしています。
- **バイナリ整合性と VirusTotal 検証:** 配布されるバイナリは、アンチウイルスベンダー各社によるスキャン（VirusTotal）をパスし、誤検知を排除。ユーザーが手にするバイナリが「真正なものであること」を証明していま���。

#### ● 標準ライブラリ `ta` クレートの採用
計算の完全性を高めるため、コア演算には検証済みの `ta` クレートを採用し、独自実装による計算ミスを最小化。すべてを `f64` で統一し、再現性を確固たるものにしています。

---

## 2. 機密性（Confidentiality）：システムへの誠実さと資産の防衛
「利用者のシステムやデータに如何なるリスクも与えない」こと。OS上で動作する一市民としてのプログラムのあり方を、私たちは追求しました。

#### ● OSとデータを侵害しない Rust の力
- **安全なメモリ管理:** メモリ安全性を保証する Rust を採用し、ポインタの不正操作による侵害を封殺。`unwrap()` や `expect()` を安易に使わず、システム資源への誠実さを保っています。
- **多層サニタイズ:** ファイル、ティッカー、ニュースクエリ、LLMノート。外部からの入力が通過するすべての境界線で、不正な文字や過長データを検知し、無効化します。

#### ● 資産価値としての API キー管理
- **読込直後の封殺:** `tickwise.env` から読み取ったAPIキーは、メモリ上の安全な領域で管理し、利用後はただちに廃棄（パディング）を行います。
- **露出の構造的ブロック:** ログや構造体において、APIキーはフィールドとして存在しません。`--debug-args` 等の表示時も、マスク処理によってキーを追跡不能にしています。

---

## 3. 可用性（Availability）：止まらない論理、揺るがない信頼
想定アイデアが素晴らしくても、ツールが動作しなければ意味がありません。

#### ● 異常終了（Crash）の完全排除
- **`unwrap` の完全排除:** すべてのエラーチェックを構造化し、異常終了という「逃げ」を自分たちに禁じました。どのような不安定なネットワーク環境下でも、安全にエラーを報告し、処理を継続する堅牢さを実現しています。

#### ● 不測の事態でも止まらない仕組み
APIレスポンスの欠陥や予期せぬ設定に対しても、安全なデフォルト動作（フォールバック）を定義。出力形式を常に一定に保つことで、他のツールとの連携においても高い可用性を発揮します。

---

## 設計者としての誇り
Tickwiseには「想定されるあらゆるセキュリティの配慮」が施されています。すべてのコード、すべてのモジュールに込められた情熱は、ユーザーがどんな環境でも自信を持って利用できるための「約束」です。

**「壊れない、嘘をつかない、漏らさない。」**
この極当たり前のことを最高水準で追求し続けること。それが Tickwise のアイデンティティです。クを持たせません。これにより、画面表示、CSV/JSONログ、LLMプロンプトのすべてにおいて、寸分違わぬ「同一の数値」が供給されることを保証しています。
- **計算の「ブレ」を許さない:** 実行タイミングや精度の揺れによる不整合を構造的に排除し、解析の最初から最後までデータの整合性を維持します。

#### ● 標準ライブラリ `ta` クレートの採用
計算の完全性を高めるため、コアとなるテクニカル指標の算出にはRustの業界標準ライブラリである `ta` クレートを採用し、独自実装によるリスクを最小化しています。
- **精度の統一:** すべての演算は `f64` に完全統一。型変換に伴う微細な精度の欠落さえも許容せず、計算結果の再現性を確固たるものにしています。

> 各指標の具体的な算出ロジックについては [indicator-guide.md](./indicator-guide.md) を参照してください。

---

## 2. 機密性（Confidentiality）：システムへの誠実さと資産の防衛
「利用者のシステムやデータに如何なるリスクも与えない」こと。OS上で動作する一市民としてのプログラムのあり方を、私たちは追求しました。

#### ● OSとデータを侵害しない Rust の力
- **安全なメモリ管理:** メモリリークやセグメントエラーのリスクを排除する Rust を採用。`unwrap()` や `expect()` を安易に使わず、エラー処理に `Result` と `Option` を慎重に用いることで、システム資源への誠実さを保っています。
- **データサニタイズの多層防護:** ファイル、ティッカー、ニュースクエリ、LLMノート。外部からの入力が通過するすべての境界線で、不正な文字や過長データを検知し、無効化します。

#### ● 資産価値としての API キー管理
- **読込直後の封殺:** `tickwise.env` から読み取ったAPIキーは、メモリ上の安全な領域で管理し、利用後はただちに廃棄（パディング）を行います。
- **露出の構造的ブロック:** ログや構造体において、APIキーはフィールドとして存在しません。`--debug-args` 等の表示時も、マスク処理によってキーを追跡不能にしています。

---

## 3. 可用性（Availability）：止まらない論理、揺るがない信頼
想定アイデアが素晴らしくても、ツールが動作しなければ意味がありません。

#### ● 異常終了（Crash）の完全排除
- **`unwrap` の完全排除:** すべてのエラーチェックを構造化し、異常終了という「逃げ」を自分たちに禁じました。どのような不安定なネットワーク環境下でも、安全にエラーを報告し、処理を継続または終了する堅牢さを実現しています。

#### ● 不測の事態でも止まらない仕組み
APIレスポンスの欠落や予期せぬ設定に対しても、安全なデフォルト動作（フォールバック）を定義。出力形式を常に一定に保つことで、他のツールとの連携においても高い可用性を発揮します。

---

## 設計者としての誇り
Tickwiseには「想定されるあらゆるセキュリティの配慮」が施されています。すべてのコード、すべてのモジュールに込められた情熱は、ユーザーがどんな環境でも自信を持って利用できるための「約束」です。

**「壊れない、嘘をつかない、漏らさない。」**
この極当たり前のことを最高水準で追求し続けること。それが Tickwise のアイデンティティです。